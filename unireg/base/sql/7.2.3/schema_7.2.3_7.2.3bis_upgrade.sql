-- Version
INSERT INTO VERSION_DB (VERSION_NB, SCRIPT_ID) VALUES ('7.2.3bis', '7.2.3_7.2.3bis_upgrade');

-- SIFISC-25583 : ajouté la date de début technique sur les raisons d'acquisition RF
ALTER TABLE RF_RAISON_ACQUISITION ADD DATE_DEBUT NUMBER(10) NULL;
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20161231 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 03:48:44.195000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 04:18:20.817000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170107 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 09:33:25.487000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 09:38:29.156000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170114 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 12:18:41.249000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 12:23:46.897000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170121 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 12:40:33.883000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 12:45:39.368000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170128 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 13:01:21.846000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 13:06:26.812000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170204 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 13:21:50.447000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 13:27:04.767000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170211 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 13:52:32.593000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 13:57:37.984000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170225 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 14:28:37.799000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 14:33:47.602000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170304 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 14:51:14.669000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 14:56:18.281000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170313 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 15:18:19.726000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 15:23:25.777000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170318 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 16:12:14.491000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 16:17:17.163000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170325 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 16:32:22.999000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 16:37:30.223000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170401 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 17:20:33.538000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 17:25:43.165000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170408 where LOG_CDATE >= TO_TIMESTAMP('2017-06-10 18:05:44.170000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-10 18:10:51.388000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170422 where LOG_CDATE >= TO_TIMESTAMP('2017-06-19 11:52:17.067000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-19 11:57:25.387000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170429 where LOG_CDATE >= TO_TIMESTAMP('2017-06-20 15:05:09.480000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-20 15:10:20.596000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170506 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 07:03:23.563000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 07:08:31.741000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170513 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 07:23:29.881000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 07:28:33.111000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170520 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 07:43:56.502000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 07:49:02.211000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170527 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 11:55:01.566000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 11:59:05.556000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170603 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 13:41:47.931000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 13:46:55.608000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170610 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 14:21:45.287000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 14:26:49.421000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170617 where LOG_CDATE >= TO_TIMESTAMP('2017-06-21 14:56:14.693000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-21 15:01:22.500000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170624 where LOG_CDATE >= TO_TIMESTAMP('2017-06-30 16:33:44.261000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-06-30 16:38:49.770000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170701 where LOG_CDATE >= TO_TIMESTAMP('2017-07-06 12:13:30.979000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-07-06 12:18:37.232000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170708 where LOG_CDATE >= TO_TIMESTAMP('2017-08-22 13:00:32.962000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-22 13:05:37.903000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170716 where LOG_CDATE >= TO_TIMESTAMP('2017-08-22 13:33:08.821000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-22 13:38:12.185000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170723 where LOG_CDATE >= TO_TIMESTAMP('2017-08-22 13:50:08.028000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-22 13:55:11.844000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170730 where LOG_CDATE >= TO_TIMESTAMP('2017-08-22 14:06:57.888000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-22 14:13:03.164000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170806 where LOG_CDATE >= TO_TIMESTAMP('2017-08-22 15:07:18.454000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-22 15:12:24.941000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170813 where LOG_CDATE >= TO_TIMESTAMP('2017-08-23 10:08:50.712000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-23 10:13:56.271000', 'YYYY-MM-DD HH24:MI:SS.FF6');
UPDATE RF_RAISON_ACQUISITION set DATE_DEBUT = 20170820 where LOG_CDATE >= TO_TIMESTAMP('2017-08-23 10:28:48.371000', 'YYYY-MM-DD HH24:MI:SS.FF6') and LOG_CDATE <= TO_TIMESTAMP('2017-08-23 10:33:54.328000', 'YYYY-MM-DD HH24:MI:SS.FF6');
ALTER TABLE RF_RAISON_ACQUISITION MODIFY DATE_DEBUT NOT NULL;
