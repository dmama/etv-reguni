<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

	<!-- POM for Unireg base dir -->

	<modelVersion>4.0.0</modelVersion>

	<groupId>ch.vd.uniregctb</groupId>
	<artifactId>uniregctb</artifactId>
	<!-- BEGIN_LVERSION -->
	<version>6.0.4-SNAPSHOT</version>
	<!-- END_LVERSION -->
	<packaging>pom</packaging>

	<name>Unireg - Base</name>
	<description>UniregCTB - Le registre unifie de l'Etat de Vaud</description>

	<modules>
		<module>../core</module>
		<module>../interfaces</module>
		<module>../business</module>
		<module>../avatars</module>
		<module>../nexus</module>
		<module>../web</module>
		<module>../ws</module>
	</modules>

	<developers>
	</developers>

	<prerequisites>
		<maven>2.0.9</maven>
	</prerequisites>
	<licenses>
		<license>
			<name/>
			<url/>
		</license>
	</licenses>
	<ciManagement/>
	<scm>
		<connection>scm:svn:https://svn.etat-de-vaud.ch/SVN_SOCLE/registre/unireg/trunk/04-Implementation/unireg/</connection>
		<developerConnection>scm:svn:https://svn.etat-de-vaud.ch/SVN_SOCLE/registre/unireg/trunk/04-Implementation/unireg/</developerConnection>
		<url/>
	</scm>

	<issueManagement>
		<system>jira</system>
		<url>http://issuetracker.etat-de-vaud.ch/jira/browse/SIFISC</url>
	</issueManagement>

	<build>
		<defaultGoal>install</defaultGoal>
		<plugins>
			<plugin>
				<!-- Build -->
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>cobertura-maven-plugin</artifactId>
				<version>${cobertura.version}</version>
				<configuration>
					<maxmem>512m</maxmem>
				</configuration>
			</plugin>
			<plugin>
				<artifactId>maven-compiler-plugin</artifactId>
				<version>2.0.2</version>
				<configuration>
					<encoding>UTF-8</encoding>
					<source>1.7</source>
					<target>1.7</target>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.4.2</version>
				<configuration>
					<argLine>${surefire.argline}</argLine>
				</configuration>
			</plugin>
		</plugins>
	</build>

	<repositories>
		<repository>
			<id>releases</id>
			<name>Releases de l'Etat de Vaud</name>
			<url>${nexus.url.releases}</url>
		</repository>
		<repository>
			<id>snapshots</id>
			<name>Snapshots de l'Etat de Vaud</name>
			<url>${nexus.url.snapshots}</url>
		</repository>
		<repository>
			<id>central</id>
			<name>Central Repository</name>
			<url>http://repo1.maven.org/maven2</url>
		</repository>
		<repository>
			<id>openqa</id>
			<name>OpenQA Repository</name>
			<url>http://maven.openqa.org</url>
		</repository>
		<repository>
			<id>apache-snapshots</id>
			<name>Apache SNAPSHOT Repository</name>
			<url>http://people.apache.org/repo/m2-snapshot-repository/</url>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</repository>
		<repository>
			<id>apache-incubating</id>
			<name>Apache Incubating Repository</name>
			<url>http://people.apache.org/repo/m2-incubating-repository/</url>
		</repository>
	</repositories>

	<pluginRepositories>
		<pluginRepository>
			<id>codehaus-repository</id>
			<url>http://repository.codehaus.org/</url>
		</pluginRepository>
		<pluginRepository>
			<id>codehaus-snapshots</id>
			<url>http://snapshots.repository.codehaus.org/</url>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</pluginRepository>
	</pluginRepositories>

	<dependencies>
		<dependency>
			<groupId>ch.vd.shared</groupId>
			<artifactId>shared-date</artifactId>
			<version>2.1.1</version>
		</dependency>
		<dependency>
            <groupId>ch.vd.shared</groupId>
            <artifactId>shared-base</artifactId>
			<version>${shared-base.version}</version>
        </dependency>
		<dependency>
			<groupId>ch.vd.shared</groupId>
			<artifactId>shared-hibernate</artifactId>
			<version>4.7.1</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-core</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-beans</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-aop</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-orm</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-tx</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jms</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context-support</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-core</artifactId>
			<version>${spring.security.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-acl</artifactId>
			<version>${spring.security.version}</version>
		</dependency>
		<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>jstl</artifactId>
			<version>${jstl.version}</version>
		</dependency>
		<dependency>
			<groupId>taglibs</groupId>
			<artifactId>standard</artifactId>
			<version>${taglibs.standard.version}</version>
		</dependency>
		<dependency>
			<groupId>commons-fileupload</groupId>
			<artifactId>commons-fileupload</artifactId>
			<version>1.2.2</version>
		</dependency>
		<dependency>
			<groupId>commons-io</groupId>
			<artifactId>commons-io</artifactId>
			<version>2.4</version>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-core</artifactId>
			<version>4.2.18.Final</version>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-validator</artifactId>
			<version>4.3.0.Final</version>
		</dependency>
		<dependency>
			<groupId>javax.validation</groupId>
			<artifactId>validation-api</artifactId>
			<version>1.0.0.GA</version>
		</dependency>
		<dependency>
			<groupId>cglib</groupId>
			<artifactId>cglib-nodep</artifactId>
			<version>2.2</version>
		</dependency>
		<dependency>
			<!--
				On est obligé de garder celui-là aussi - en plus du org.apache.commons / commons-lang3 plus bas - à cause
				de dépendances de projets comme commons-configuration qui, en version 1.9 (la dernière version disponible
				à ce jour), CXF, ... ont encore besoin des anciens packages...
				... mais on ne peut pas non-plus garder que celui-là (et ne pas du tout passer au nouveau) car shared-hibernate
				en version 4.x dépend de commons-lang3
			-->
			<groupId>commons-lang</groupId>
			<artifactId>commons-lang</artifactId>
			<version>2.6</version>
		</dependency>
		<dependency>
			<groupId>org.apache.commons</groupId>
			<artifactId>commons-lang3</artifactId>
			<version>3.3.2</version>
		</dependency>
		<dependency>
			<groupId>commons-beanutils</groupId>
			<artifactId>commons-beanutils-core</artifactId>
			<version>1.8.3</version>
		</dependency>
		<dependency>
			<groupId>org.apache.commons</groupId>
			<artifactId>commons-collections4</artifactId>
			<version>4.0</version>
		</dependency>
		<dependency>
			<groupId>log4j</groupId>
			<artifactId>log4j</artifactId>
			<version>${log4j.version}</version>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-log4j12</artifactId>
			<version>${slf4j.version}</version>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-api</artifactId>
			<version>${slf4j.version}</version>
		</dependency>
		<dependency>
			<groupId>trove</groupId>
			<artifactId>trove</artifactId>
			<version>1.1-beta-5</version>
		</dependency>
		<dependency>
			<groupId>com.itextpdf</groupId>
			<artifactId>itextpdf</artifactId>
			<version>5.5.1</version>
		</dependency>
		<dependency>
			<groupId>net.sf.ehcache</groupId>
			<artifactId>ehcache</artifactId>
			<version>1.4.1</version>
		</dependency>
		<dependency>
			<groupId>org.jetbrains</groupId>
			<artifactId>annotations</artifactId>
			<version>6.0.2</version>
		</dependency>
		<!--  Deps de testing -->
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-test</artifactId>
			<version>${spring.version}</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>${junit.version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>

	<reporting>
		<plugins>
			<plugin>
				<!-- Workaround pour bug http://jira.codehaus.org/browse/MPIR-103 (voir aussi http://jira.codehaus.org/browse/MSITE-332) -->
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-project-info-reports-plugin</artifactId>
				<version>2.0.1</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-resources-plugin</artifactId>
				<version>2.4.3</version>
				<configuration>
					<encoding>UTF-8</encoding>
				</configuration>
			</plugin>

			<plugin>
				<!-- Reporting -->
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>cobertura-maven-plugin</artifactId>
				<version>${cobertura.version}</version>
			</plugin>
			<plugin>
			    <groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jxr-plugin</artifactId>
				<version>2.1</version>
				<configuration>
					<aggregate>true</aggregate>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-pmd-plugin</artifactId>
				<version>2.4</version>
				
				<configuration>
					<rulesets>
						<ruleset>/rulesets/basic.xml</ruleset>
						<ruleset>/rulesets/imports.xml</ruleset>
						<ruleset>/rulesets/unusedcode.xml</ruleset>
						<ruleset>/rulesets/finalizers.xml</ruleset>
					</rulesets>
					<linkXref>true</linkXref>
					<sourceEncoding>utf-8</sourceEncoding>
					<targetJdk>1.5</targetJdk>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-report-plugin</artifactId>
				<version>2.4.2</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-javadoc-plugin</artifactId>
				<version>2.9</version>
				<configuration>
					<doclet>org.umlgraph.doclet.UmlGraphDoc</doclet>
					<docletArtifact>
						<groupId>org.umlgraph</groupId>
						<artifactId>umlgraph</artifactId>
						<version>5.6.6</version>
					</docletArtifact>
					<encoding>UTF-8</encoding>
					<source>1.7</source>
					<additionalparam>
						-inferrel -inferdep -quiet -hide java.* -collpackages java.util.* -qualify -postfixpackage -nodefontsize 9
						-nodefontpackagesize 7
					</additionalparam>
					<additionalJOption>-J-Xmx1024m -Xdoclint:none</additionalJOption>
					<aggregate>true</aggregate>
					<excludePackageNames>javax.jws.*:ch.vd.uniregctb.webservices.*</excludePackageNames>
					<links>
						<link>http://docs.oracle.com/javase/7/docs/api/</link>
					</links>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>dashboard-maven-plugin</artifactId>
				<version>1.0.0-beta-1</version>
			</plugin>
		</plugins>
	</reporting>
	<distributionManagement>
		<site>
			<id>unireg.website</id>
			<url>scp://tom.etat-de-vaud.ch/var/www/html/unireg/javadoc-site/uniregctb-base</url>
		</site>
		<repository>
			<id>nexus.releases</id>
			<name>Nexus releases</name>
			<url>${nexus.url.releases}</url>
		</repository>
		<snapshotRepository>
			<id>nexus.snapshots</id>
			<name>Nexus snaphots</name>
			<url>${nexus.url.snapshots}</url>
			<!-- évite d'ajouter un timestamp à chaque déploiement : nécessaire pour avoir les sources synchrones avec un jar snapshot -->
			<uniqueVersion>false</uniqueVersion>
		</snapshotRepository>
	</distributionManagement>


	<!-- ================= Profils utilisateurs ================= -->
	<profiles>
		<!-- ================= Modules Profiles ================= -->
		<profile>
			<id>ext</id>
			<modules>
				<module>../ubr</module>
			</modules>
		</profile>
		<profile>
			<id>it</id>
			<modules>
				<!-- web-it a besoin de ubr -->
				<module>../ubr</module>
				<module>../business-it</module>
				<module>../web-it</module>
			</modules>
		</profile>
		<profile>
			<id>all</id>
			<modules>
				<module>../ubr</module>
				<module>../business-it</module>
				<module>../web-it</module>
				<module>../tools</module>
			</modules>
		</profile>

		<!-- ================= Profile pour les developpeurs pour éviter l'utilisation du cache centralisé Nexus ================= -->

		<profile>
			<id>no-nexus</id>
			<properties>
				<interfaces-mode>direct</interfaces-mode>
			</properties>
		</profile>

		<!-- ================= Profile pour les developpeurs pour skipper les tests  ================= -->
		
		<profile>
			<id>not</id><!-- NOTests -->
			<properties>
				<skipTests>true</skipTests>
			</properties>
		</profile>

		<!-- ================= Database Profiles ================= -->

		<profile>
			<id>oracle</id>
			<dependencies>
				<dependency>
					<groupId>oracle.jdbc</groupId>
					<artifactId>ojdbc7</artifactId>
					<version>${oracle.version}</version>
					<scope>provided</scope>
				</dependency>
			</dependencies>
		</profile>
		<profile>
			<id>postgresql</id>
			<dependencies>
				<dependency>
					<groupId>org.postgresql</groupId>
					<artifactId>postgresql</artifactId>
					<version>${postgresql.version}</version>
					<scope>provided</scope>
				</dependency>
				<dependency>
					<groupId>org.tranql</groupId>
					<artifactId>tranql-connector-postgresql-common</artifactId>
					<version>1.5</version>
					<scope>provided</scope>
				</dependency>
			</dependencies>
		</profile>

		<!-- =================== Environnement profiles -->
		
		<profile>
			<!-- version standalone d'Unireg qui ne nécessite qu'une base de données Oracle pour fonctionner (pas de host, pas d'esb, ...) -->
			<id>env.standalone</id>
			<properties>
				<unireg.standalone>true</unireg.standalone>
				<unireg.webxml>web.standalone.xml</unireg.webxml>
				<unireg.webreleasexml>release.standalone.xml</unireg.webreleasexml>
			</properties>
		</profile>

		<profile>
			<id>build.source</id>
			<build>
				<plugins>
					<plugin>
						<artifactId>maven-source-plugin</artifactId>
						<executions>
							<execution>
								<goals>
									<goal>jar</goal>
								</goals>
								<phase>package</phase>
							</execution>
						</executions>
					</plugin>
				</plugins>
			</build>
		</profile>

		<profile>
			<id>jacoco</id>
			<properties>
				<surefire.argline>-javaagent:${jacoco.agent.path}=destfile=${jacoco.dump.path} -Xmx512m -XX:PermSize=128m -XX:MaxPermSize=512m</surefire.argline>
			</properties>
		</profile>
	</profiles>
	
	<properties>

		<!-- Maven settings -->
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		
		<!--  Deployment settings -->
		<!--<unireg.deploymenturl>/fiscalite/unireg</unireg.deploymenturl>-->
		<unireg-web.appname>unireg-web</unireg-web.appname>
		<unireg-ws.appname>unireg-ws</unireg-ws.appname>
		<unireg-nexus.appname>unireg-nexus</unireg-nexus.appname>
		<unireg.standalone>false</unireg.standalone>
		<unireg.webxml>web.normal.xml</unireg.webxml>
		<unireg.webreleasexml>release.xml</unireg.webreleasexml>

		<interfaces-mode>nexus</interfaces-mode>

		<unireg.properties.path>${ch.vd.appDir}/${unireg-web.appname}/config/unireg.properties</unireg.properties.path>
		<credentials.properties.path>${ch.vd.appDir}/${unireg-web.appname}/config/credentials.properties</credentials.properties.path>
		<unireg.log4j.location>file:${ch.vd.appDir}/${unireg-web.appname}/config/unireg-log4j.xml</unireg.log4j.location>

		<unireg-ws.properties.path>${ch.vd.appDir}/${unireg-ws.appname}/config/unireg.properties</unireg-ws.properties.path>
		<unireg-ws.credentials.path>${ch.vd.appDir}/${unireg-ws.appname}/config/credentials.properties</unireg-ws.credentials.path>
		<unireg-ws.log4j.location>file:${ch.vd.appDir}/${unireg-ws.appname}/config/unireg-log4j.xml</unireg-ws.log4j.location>

		<unireg-nexus.properties.path>${ch.vd.appDir}/${unireg-nexus.appname}/config/unireg.properties</unireg-nexus.properties.path>
		<unireg-nexus.credentials.path>${ch.vd.appDir}/${unireg-nexus.appname}/config/credentials.properties</unireg-nexus.credentials.path>
		<unireg-nexus.log4j.location>file:${ch.vd.appDir}/${unireg-nexus.appname}/config/unireg-log4j.xml</unireg-nexus.log4j.location>

		<!-- Application settings -->
		<copyright.year>2015</copyright.year>
		<dao.framework>hibernate</dao.framework>
		<web.framework>spring</web.framework>
		<amp.genericCore>true</amp.genericCore>
		<amp.fullSource>false</amp.fullSource>

		<!-- Web application versions -->
		<jsp.version>2.2</jsp.version>
		<servlet.version>3.1.0</servlet.version>
		<jstl.version>1.2</jstl.version>
		<taglibs.standard.version>1.1.2</taglibs.standard.version>

		<!-- Framework dependency versions -->
		<tomcat.version>8.0.17</tomcat.version>
		<embedded-tomcat.version>4.0.0</embedded-tomcat.version>
		<shared-base.version>5.5.2</shared-base.version>
		<spring.version>3.2.13.RELEASE</spring.version>
		<spring.security.version>3.2.5.RELEASE</spring.security.version>
		<cxf.version>2.6.0.fuse-71-047</cxf.version>
		<activemq.version>5.11.0.redhat-620133</activemq.version>
		<jencks.version>2.2</jencks.version>
		<jackson.version>1.9.13</jackson.version>
		<wsparty3.version>3.8</wsparty3.version>
		<wsparty4.version>4.1</wsparty4.version>
		<ws.v5.version>5.4.1</ws.v5.version>
		<ws.v6.version>6.0</ws.v6.version>

		<!-- Testing dependency versions -->
		<junit.version>4.12</junit.version>
		<javamail.version>1.4</javamail.version>
		<log4j.version>1.2.17</log4j.version>
		<slf4j.version>1.7.7</slf4j.version>
		<oro.version>2.0.8</oro.version>
		<cobertura.version>2.6</cobertura.version>

		<!-- Database settings -->
		<oracle.version>12.1.0.2.0</oracle.version>
		<oracle.jdbc.driverClassName>oracle.jdbc.OracleDriver</oracle.jdbc.driverClassName>
		<oracle.hibernate.dialect>ch.vd.uniregctb.hibernate.dialect.Oracle10gDialectWithNVarChar</oracle.hibernate.dialect>
		<oracle.hibernate.query.substitutions>true 1, false 0</oracle.hibernate.query.substitutions>

		<postgresql.version>9.3-1102-jdbc4</postgresql.version>
		<postgresql.jdbc.driverClassName>org.postgresql.Driver</postgresql.jdbc.driverClassName>
		<postgresql.hibernate.dialect>ch.vd.uniregctb.hibernate.dialect.PostgreSQL83Dialect</postgresql.hibernate.dialect>
		<postgresql.hibernate.query.substitutions/>
		
		<dbunit.version>2.2.3</dbunit.version>
		<dbunit.dataTypeFactoryName>org.dbunit.dataset.datatype.DefaultDataTypeFactory</dbunit.dataTypeFactoryName>
		<dbunit.operation.type>CLEAN_INSERT</dbunit.operation.type>

		<!-- Version des Host-Interfaces -->
		<host-interfaces.version-short>1.9</host-interfaces.version-short>
		<host-interfaces.version-long>1.9.50</host-interfaces.version-long>
		<host-interfaces.factory>weblogic.jndi.WLInitialContextFactory</host-interfaces.factory>
		<host-interfaces.ejb-proxy-class>ch.vd.uniregctb.ejb.GentilRemoteStatelessSessionProxyFactoryBean</host-interfaces.ejb-proxy-class>

		<!-- Parametres de Testing -->
		<surefire.useFile>false</surefire.useFile>
		<surefire.argline>-Xms256m -Xmx512m -DUseSunHttpHandler=true -XX:-UseSplitVerifier</surefire.argline>

		<!-- Editique -->
		<!-- Temps de timeout lors des impressions locales qui doivent être synchrones -->
		<editique.locale.sync.attente.timeout>120</editique.locale.sync.attente.timeout>
		<!-- Délai d'attente avant qu'une impression locale pas nécessairement synchrone soit re-routée vers l'inbox du demandeur -->
		<editique.locale.async.attente.delai>15</editique.locale.async.attente.delai>
	</properties>

</project>
