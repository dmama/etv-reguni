<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

	<!-- POM for Unireg base dir -->

	<modelVersion>4.0.0</modelVersion>

	<groupId>ch.vd.uniregctb</groupId>
	<artifactId>uniregctb</artifactId>
	<!-- BEGIN_LVERSION -->
	<version>5.4.0-SNAPSHOT</version>
	<!-- END_LVERSION -->
	<packaging>pom</packaging>

	<name>Unireg - Base</name>
	<description>UniregCTB - Le registre unifie de l'Etat de Vaud</description>

	<modules>
		<module>../core</module>
		<module>../interfaces</module>
		<module>../business</module>
		<module>../nexus</module>
		<module>../web</module>
		<module>../ws</module>
	</modules>

	<developers>
	</developers>

	<prerequisites>
		<maven>2.0.9</maven>
	</prerequisites>
	<licenses>
		<license>
			<name/>
			<url/>
		</license>
	</licenses>
	<ciManagement/>
	<scm>
		<connection>scm:svn:http://subversion.etat-de-vaud.ch/SVN_ACI/registre/unireg/trunk/04-Implementation/unireg/</connection>
		<developerConnection>scm:svn:http://subversion.etat-de-vaud.ch/SVN_ACI/registre/unireg/trunk/04-Implementation/unireg/</developerConnection>
		<url/>
	</scm>

	<issueManagement>
		<system>jira</system>
		<url>http://issuetracker.etat-de-vaud.ch/jira/browse/SIFISC</url>
	</issueManagement>

	<build>
		<defaultGoal>install</defaultGoal>
		<plugins>
			<plugin>
				<!-- Build -->
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>cobertura-maven-plugin</artifactId>
				<version>${cobertura.version}</version>
				<configuration>
					<maxmem>512m</maxmem>
				</configuration>
			</plugin>
			<plugin>
				<artifactId>maven-compiler-plugin</artifactId>
				<version>2.0.2</version>
				<configuration>
					<encoding>UTF-8</encoding>
					<source>1.7</source>
					<target>1.7</target>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.4.2</version>
				<configuration>
					<argLine>${surefire.argline}</argLine>
				</configuration>
			</plugin>
		</plugins>
	</build>

	<repositories>
		<repository>
			<id>releases</id>
			<name>Releases de l'Etat de Vaud</name>
			<url>${nexus.url.releases}</url>
		</repository>
		<repository>
			<id>snapshots</id>
			<name>Snapshots de l'Etat de Vaud</name>
			<url>${nexus.url.snapshots}</url>
		</repository>
		<repository>
			<id>central</id>
			<name>Central Repository</name>
			<url>http://repo1.maven.org/maven2</url>
		</repository>
		<repository>
			<id>openqa</id>
			<name>OpenQA Repository</name>
			<url>http://maven.openqa.org</url>
		</repository>
		<repository>
			<id>apache-snapshots</id>
			<name>Apache SNAPSHOT Repository</name>
			<url>http://people.apache.org/repo/m2-snapshot-repository/</url>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</repository>
		<repository>
			<id>apache-incubating</id>
			<name>Apache Incubating Repository</name>
			<url>http://people.apache.org/repo/m2-incubating-repository/</url>
		</repository>
	</repositories>

	<pluginRepositories>
		<pluginRepository>
			<id>codehaus-repository</id>
			<url>http://repository.codehaus.org/</url>
		</pluginRepository>
		<pluginRepository>
			<id>codehaus-snapshots</id>
			<url>http://snapshots.repository.codehaus.org/</url>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</pluginRepository>
	</pluginRepositories>

	<dependencies>
		<dependency>
			<groupId>ch.vd.registre</groupId>
			<artifactId>shared-date</artifactId>
			<version>2.0.1</version>
		</dependency>
		<dependency>
            <groupId>ch.vd.registre</groupId>
            <artifactId>shared-base</artifactId>
			<version>${shared-base.version}</version>
        </dependency>
		<dependency>
			<groupId>ch.vd.registre</groupId>
			<artifactId>shared-hibernate</artifactId>
			<version>1.1.0</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-core</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-beans</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-aop</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-orm</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-tx</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jms</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context-support</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-core</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-acl</artifactId>
			<version>${spring.version}</version>
		</dependency>
		<dependency>
			<groupId>javax.persistence</groupId>
			<artifactId>persistence-api</artifactId>
			<version>1.0</version>
		</dependency>
		<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>jstl</artifactId>
			<version>${jstl.version}</version>
		</dependency>
		<dependency>
			<groupId>taglibs</groupId>
			<artifactId>standard</artifactId>
			<version>${jstl.version}</version>
		</dependency>
		<dependency>
			<groupId>commons-fileupload</groupId>
			<artifactId>commons-fileupload</artifactId>
			<version>1.2</version>
		</dependency>
		<dependency>
			<groupId>commons-io</groupId>
			<artifactId>commons-io</artifactId>
			<version>1.3.1</version>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-core</artifactId>
			<version>3.3.2.GA</version>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-annotations</artifactId>
			<version>3.4.0.GA</version>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-commons-annotations</artifactId>
			<version>3.3.0.ga</version>
			<exclusions>
				<exclusion>
					<!--Pour ne pas tirer la version 1.5.3 de asm -->
					<groupId>org.hibernate</groupId>
					<artifactId>hibernate</artifactId>
				</exclusion>
			</exclusions>
		</dependency>
		<dependency>
		   <groupId>javassist</groupId>
		   <artifactId>javassist</artifactId>
		   <version>3.9.0.GA</version>
	   </dependency>
		<dependency>
			<groupId>cglib</groupId>
			<artifactId>cglib-nodep</artifactId>
			<version>2.2</version>
		</dependency>
		<dependency>
			<groupId>commons-lang</groupId>
			<artifactId>commons-lang</artifactId>
			<version>2.2</version>
		</dependency>
		<dependency>
			<groupId>commons-beanutils</groupId>
			<artifactId>commons-beanutils-core</artifactId>
			<version>1.7.0</version>
		</dependency>
		<dependency>
			<groupId>commons-collections</groupId>
			<artifactId>commons-collections</artifactId>
			<version>3.2.1</version>
		</dependency>
		<dependency>
			<groupId>log4j</groupId>
			<artifactId>log4j</artifactId>
			<version>${log4j.version}</version>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-log4j12</artifactId>
			<version>${slf4j.version}</version>
		</dependency>
		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-api</artifactId>
			<version>${slf4j.version}</version>
		</dependency>
		<dependency>
			<groupId>trove</groupId>
			<artifactId>trove</artifactId>
			<version>1.1-beta-5</version>
		</dependency>
		<dependency>
			<groupId>com.lowagie</groupId>
			<artifactId>itext</artifactId>
			<version>2.1.3</version>
		</dependency>
		<dependency>
			<groupId>net.sf.ehcache</groupId>
			<artifactId>ehcache</artifactId>
			<version>1.4.1</version>
		</dependency>
		<dependency>
			<groupId>org.jetbrains</groupId>
			<artifactId>annotations</artifactId>
			<version>6.0.2</version>
		</dependency>
		<!--  Deps de testing -->
		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-test</artifactId>
			<version>${spring.version}</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>${junit.version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>

	<reporting>
		<plugins>
			<plugin>
				<!-- Workaround pour bug http://jira.codehaus.org/browse/MPIR-103 (voir aussi http://jira.codehaus.org/browse/MSITE-332) -->
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-project-info-reports-plugin</artifactId>
				<version>2.0.1</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-resources-plugin</artifactId>
				<version>2.4.3</version>
				<configuration>
					<encoding>UTF-8</encoding>
				</configuration>
			</plugin>

			<plugin>
				<!-- Reporting -->
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>cobertura-maven-plugin</artifactId>
				<version>${cobertura.version}</version>
			</plugin>
			<plugin>
			    <groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jxr-plugin</artifactId>
				<version>2.1</version>
				<configuration>
					<aggregate>true</aggregate>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-pmd-plugin</artifactId>
				<version>2.4</version>
				
				<configuration>
					<rulesets>
						<ruleset>/rulesets/basic.xml</ruleset>
						<ruleset>/rulesets/imports.xml</ruleset>
						<ruleset>/rulesets/unusedcode.xml</ruleset>
						<ruleset>/rulesets/finalizers.xml</ruleset>
					</rulesets>
					<linkXref>true</linkXref>
					<sourceEncoding>utf-8</sourceEncoding>
					<targetJdk>1.5</targetJdk>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-report-plugin</artifactId>
				<version>2.4.2</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-javadoc-plugin</artifactId>
				<version>2.9</version>
				<configuration>
					<doclet>gr.spinellis.umlgraph.doclet.UmlGraphDoc</doclet>
					<docletArtifact>
						<groupId>gr.spinellis</groupId>
						<artifactId>UmlGraph</artifactId>
						<version>4.6</version>
					</docletArtifact>
					<encoding>UTF-8</encoding>
					<additionalparam>
						-inferrel -inferdep -quiet -hide java.* -collpackages java.util.* -qualify -postfixpackage -nodefontsize 9
						-nodefontpackagesize 7
					</additionalparam>
					<additionalJOption>-J-Xmx1024m</additionalJOption>
					<aggregate>true</aggregate>
					<excludePackageNames>javax.jws.*:ch.vd.uniregctb.webservices.*</excludePackageNames>
					<links>
						<link>http://docs.oracle.com/javase/6/docs/api/</link>
					</links>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>dashboard-maven-plugin</artifactId>
				<version>1.0.0-beta-1</version>
			</plugin>
		</plugins>
	</reporting>
	<distributionManagement>
		<site>
			<id>unireg.website</id>
			<url>file:///home/slaves/hudson_unireg_doc/website4.x/</url>
		</site>
		<repository>
			<id>nexus.releases</id>
			<name>Nexus releases</name>
			<url>${nexus.url.releases}</url>
		</repository>
		<snapshotRepository>
			<id>nexus.snapshots</id>
			<name>Nexus snaphots</name>
			<url>${nexus.url.snapshots}</url>
			<!-- évite d'ajouter un timestamp à chaque déploiement : nécessaire pour avoir les sources synchrones avec un jar snapshot -->
			<uniqueVersion>false</uniqueVersion>
		</snapshotRepository>
	</distributionManagement>


	<!-- ================= Profils utilisateurs ================= -->
	<profiles>
		<!-- ================= Modules Profiles ================= -->
		<profile>
			<id>ext</id>
			<modules>
				<module>../ubr</module>
			</modules>
		</profile>
		<profile>
			<id>it</id>
			<modules>
				<!-- web-it a besoin de ubr -->
				<module>../ubr</module>
				<module>../business-it</module>
				<module>../web-it</module>
			</modules>
		</profile>
		<profile>
			<id>all</id>
			<modules>
				<module>../ubr</module>
				<module>../business-it</module>
				<module>../web-it</module>
				<module>../tools</module>
			</modules>
		</profile>

		<!-- ================= Profile pour les developpeurs pour éviter l'utilisation du cache centralisé Nexus ================= -->

		<profile>
			<id>no-nexus</id>
			<properties>
				<interfaces-mode>direct</interfaces-mode>
			</properties>
		</profile>

		<!-- ================= Profile pour les developpeurs pour skipper les tests  ================= -->
		
		<profile>
			<id>not</id><!-- NOTests -->
			<properties>
				<skipTests>true</skipTests>
			</properties>
		</profile>

		<!-- ================= Database Profiles ================= -->

		<profile>
			<id>oracle</id>
			<dependencies>
				<dependency>
					<groupId>oracle.jdbc</groupId>
					<artifactId>ojdbc6</artifactId>
					<version>${oracle.version}</version>
				</dependency>
			</dependencies>
		</profile>
		<profile>
			<id>postgresql</id>
			<dependencies>
				<dependency>
					<groupId>org.postgresql</groupId>
					<artifactId>jdbc</artifactId>
					<version>${postgresql.version}</version>
				</dependency>
				<dependency>
					<groupId>org.tranql</groupId>
					<artifactId>tranql-connector-postgresql-common</artifactId>
					<version>1.3</version>
				</dependency>
			</dependencies>
		</profile>

		<!-- =================== Environnement profiles -->
		
		<profile>
			<!-- version standalone d'Unireg qui ne nécessite qu'une base de données Oracle pour fonctionner (pas de host, pas d'esb, ...) -->
			<id>env.standalone</id>
			<properties>
				<unireg.standalone>true</unireg.standalone>
				<unireg.webxml>web.standalone.xml</unireg.webxml>
				<unireg.webreleasexml>release.standalone.xml</unireg.webreleasexml>
			</properties>
		</profile>

		<profile>
			<id>build.source</id>
			<build>
				<plugins>
					<plugin>
						<artifactId>maven-source-plugin</artifactId>
						<executions>
							<execution>
								<goals>
									<goal>jar</goal>
								</goals>
								<phase>install</phase>
							</execution>
						</executions>
					</plugin>
				</plugins>
			</build>
		</profile>

		<profile>
			<id>jacoco</id>
			<properties>
				<surefire.argline>-javaagent:${jacoco.agent.path}=destfile=${jacoco.dump.path} -Xmx512m -XX:PermSize=128m -XX:MaxPermSize=512m</surefire.argline>
			</properties>
		</profile>
	</profiles>
	
	<properties>

		<!-- Maven settings -->
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		
		<!--  Deployment settings -->
		<!--<unireg.deploymenturl>/fiscalite/unireg</unireg.deploymenturl>-->
		<unireg-web.appname>unireg-web</unireg-web.appname>
		<unireg-ws.appname>unireg-ws</unireg-ws.appname>
		<unireg-nexus.appname>unireg-nexus</unireg-nexus.appname>
		<unireg.standalone>false</unireg.standalone>
		<unireg.webxml>web.normal.xml</unireg.webxml>
		<unireg.webreleasexml>release.xml</unireg.webreleasexml>

		<interfaces-mode>nexus</interfaces-mode>

		<unireg.properties.path>${ch.vd.appDir}/${unireg-web.appname}/config/unireg.properties</unireg.properties.path>
		<credentials.properties.path>${ch.vd.appDir}/${unireg-web.appname}/config/credentials.properties</credentials.properties.path>
		<unireg.log4j.location>file:${ch.vd.appDir}/${unireg-web.appname}/config/unireg-log4j.xml</unireg.log4j.location>

		<unireg-ws.properties.path>${ch.vd.appDir}/${unireg-ws.appname}/config/unireg.properties</unireg-ws.properties.path>
		<unireg-ws.credentials.path>${ch.vd.appDir}/${unireg-ws.appname}/config/credentials.properties</unireg-ws.credentials.path>
		<unireg-ws.log4j.location>file:${ch.vd.appDir}/${unireg-ws.appname}/config/unireg-log4j.xml</unireg-ws.log4j.location>

		<unireg-nexus.properties.path>${ch.vd.appDir}/${unireg-nexus.appname}/config/unireg.properties</unireg-nexus.properties.path>
		<unireg-nexus.credentials.path>${ch.vd.appDir}/${unireg-nexus.appname}/config/credentials.properties</unireg-nexus.credentials.path>
		<unireg-nexus.log4j.location>file:${ch.vd.appDir}/${unireg-nexus.appname}/config/unireg-log4j.xml</unireg-nexus.log4j.location>

		<!-- Application settings -->
		<copyright.year>2011</copyright.year>
		<dao.framework>hibernate</dao.framework>
		<web.framework>spring</web.framework>
		<amp.genericCore>true</amp.genericCore>
		<amp.fullSource>false</amp.fullSource>

		<!-- Web application versions -->
		<jsp.version>2.2</jsp.version>
		<servlet.version>3.0-alpha-1</servlet.version>
		<jstl.version>1.1.2</jstl.version>

		<!-- Framework dependency versions -->
		<tomcat.version>7.0.32</tomcat.version>
		<embedded-tomcat.version>3.0.0</embedded-tomcat.version>
		<shared-base.version>4.12.0</shared-base.version>
		<spring.version>3.0.6.RELEASE</spring.version>
		<spring-modules.version>0.9</spring-modules.version>
		<cxf.version>2.4.3-fuse-00-20</cxf.version>
		<lucene.version>3.0.1</lucene.version>
		<activemq.version>5.5.1-fuse-01-20</activemq.version>
		<jencks.version>2.2</jencks.version>
		<wsparty3.version>3.7-SNAPSHOT</wsparty3.version>

		<!-- Testing dependency versions -->
		<junit.version>4.8.1</junit.version>
		<javamail.version>1.4</javamail.version>
		<log4j.version>1.2.14</log4j.version>
		<slf4j.version>1.6.1</slf4j.version>
		<oro.version>2.0.8</oro.version>
		<cobertura.version>2.5.1</cobertura.version>

		<!-- Database settings -->
		<oracle.version>11.2.0.1.0</oracle.version>
		<oracle.jdbc.driverClassName>oracle.jdbc.OracleDriver</oracle.jdbc.driverClassName>
		<oracle.hibernate.dialect>ch.vd.uniregctb.hibernate.dialect.Oracle10gDialectWithNVarChar</oracle.hibernate.dialect>
		<oracle.hibernate.query.substitutions>true 1, false 0</oracle.hibernate.query.substitutions>

		<postgresql.version>8.3.603</postgresql.version>
		<postgresql.jdbc.driverClassName>org.postgresql.Driver</postgresql.jdbc.driverClassName>
		<postgresql.hibernate.dialect>ch.vd.uniregctb.hibernate.dialect.PostgreSQL83Dialect</postgresql.hibernate.dialect>
		<postgresql.hibernate.query.substitutions/>
		
		<dbunit.version>2.2.3</dbunit.version>
		<dbunit.dataTypeFactoryName>org.dbunit.dataset.datatype.DefaultDataTypeFactory</dbunit.dataTypeFactoryName>
		<dbunit.operation.type>CLEAN_INSERT</dbunit.operation.type>

		<!-- Version des Host-Interfaces -->
		<host-interfaces.version-short>1.9</host-interfaces.version-short>
		<host-interfaces.version-long>1.9.48</host-interfaces.version-long>
		<host-interfaces.factory>weblogic.jndi.WLInitialContextFactory</host-interfaces.factory>
		<host-interfaces.ejb-proxy-class>ch.vd.uniregctb.ejb.GentilRemoteStatelessSessionProxyFactoryBean</host-interfaces.ejb-proxy-class>

		<!-- Parametres de Testing -->
		<surefire.useFile>false</surefire.useFile>
		<surefire.argline>-Xms256m -Xmx512m -XX:MaxPermSize=128m -DUseSunHttpHandler=true -XX:-UseSplitVerifier</surefire.argline>

		<!-- Editique -->
		<!-- Temps de timeout lors des impressions locales qui doivent être synchrones -->
		<editique.locale.sync.attente.timeout>120</editique.locale.sync.attente.timeout>
		<!-- Délai d'attente avant qu'une impression locale pas nécessairement synchrone soit re-routée vers l'inbox du demandeur -->
		<editique.locale.async.attente.delai>15</editique.locale.async.attente.delai>
	</properties>

</project>
