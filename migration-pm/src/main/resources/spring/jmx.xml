<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans	http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
							http://www.springframework.org/schema/util
							http://www.springframework.org/schema/util/spring-util-3.1.xsd">

	<!-- infrastructure d'export des beans jmx -->

	<!-- Read management interface from annotations -->
	<bean id="jmxAttributeSource" class="org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource" />
	<bean id="jmxAssembler" class="org.springframework.jmx.export.assembler.MetadataMBeanInfoAssembler">
		<property name="attributeSource" ref="jmxAttributeSource" />
	</bean>

	<!-- Liste des beans exportés en JMX au travers de leurs annotations -->
	<bean id="jmxExporter" class="org.springframework.jmx.export.MBeanExporter">
		<property name="autodetect" value="false" />
		<property name="assembler" ref="jmxAssembler" />
		<property name="beans">
			<util:map>
				<entry key="ch.vd.unireg.migration.pm:type=Monitoring,name=Engine" value-ref="engineJmxBean" />
			</util:map>
		</property>
	</bean>

	<!-- les beans eux-mêmes -->

	<bean id="engineJmxBean" class="ch.vd.uniregctb.migration.pm.jmx.EngineJmxBean">
		<property name="worker" ref="migrationWorker"/>
	</bean>

</beans>